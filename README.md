# バーチャルスクロール実装

## 概要

このプロジェクトは、大量のデータ（10,000 アイテム）を効率的に表示するためのバーチャルスクロール（仮想スクロール）機能を実装しています。すべてのアイテムを DOM に描画するのではなく、現在表示されている範囲のアイテムのみを動的にレンダリングすることで、パフォーマンスを最適化しています。

## 特徴

- **高性能**: 10,000 個のアイテムでもスムーズなスクロール体験
- **メモリ効率**: 表示されているアイテムのみを DOM に保持
- **レスポンシブ対応**: ウィンドウサイズ変更に自動対応
- **最適化されたレンダリング**: `requestAnimationFrame`を使用したスクロールイベント処理

## ファイル構成

```
├── index.html    # HTMLファイル（メインUI）
└── main.js       # バーチャルスクロールのメインロジック
```

## 設定可能な定数

### main.js 内の設定値

- `ITEM_HEIGHT`: 各アイテムの固定高さ（デフォルト: 50px）
- `TOTAL_ITEMS`: 生成するアイテムの総数（デフォルト: 10,000 個）
- `OVERSCAN`: 表示領域の上下に余分にレンダリングするアイテム数（デフォルト: 2 個）
  - ちらつき防止のためのバッファ

## 仕組み

### 1. 仮想的なスクロール領域の作成

- `virtual-scroll-track`要素で全体の高さ（`TOTAL_ITEMS × ITEM_HEIGHT`）を確保
- 実際のスクロールバーを表示するためのダミー要素

### 2. 表示範囲の計算

- 現在のスクロール位置から、表示すべきアイテムの開始・終了インデックスを計算
- オーバースキャン機能により、表示範囲の前後にも余分にアイテムを準備

### 3. 動的な DOM 操作

- 表示範囲内のアイテムのみを DOM に追加/更新
- 範囲外のアイテムは自動的に DOM から削除
- 各アイテムは絶対配置（`position: absolute`）で正確な位置に配置

### 4. パフォーマンス最適化

- スクロールイベントを`requestAnimationFrame`でラップ
- 既存のアイテムの再利用による不要な再描画の防止

## 使用方法

1. ブラウザで`index.html`を開く
2. 10,000 個のアイテムが生成されたスクロール可能なリストが表示される
3. スクロールして動作を確認

## スタイル

- 奇数行: `#f9f9f9`（薄いグレー）
- 偶数行: `#ffffff`（白）
- 各アイテムには下線（`border-bottom`）を表示
- 固定の高さ 50px で統一

## カスタマイズ

### アイテムの高さを変更する場合

1. `main.js`の`ITEM_HEIGHT`定数を変更
2. `index.html`の`.item`スタイルの`height`プロパティも同じ値に変更

### アイテム数を変更する場合

- `main.js`の`TOTAL_ITEMS`定数を変更

### データ構造をカスタマイズする場合

- `allItemsData`配列の生成ロジックを修正
- `renderItems()`関数内のアイテム作成部分を更新

## 対応ブラウザ

- モダンブラウザ（Chrome、Firefox、Safari、Edge）
- ES6+機能を使用（`Array.from`、`Set`、アロー関数など）

## パフォーマンス

- 大量データ（10,000+アイテム）でも 60FPS でスムーズなスクロール
- メモリ使用量は表示されているアイテム数に比例（通常 10〜20 個程度）
- CPU オーバーヘッドの最小化
